## 取り組んだ課題一覧
- React todoList実装

## わかったこと

- 1. completeCount が「古い値」のままになっている（非同期問題）
- Reactの setCompleteCount(completeCount - 1) という書き方は、その関数が呼ばれた瞬間の completeCount の値を参照。 もし、他の処理（例えばチェックを入れる動作など）と同時に動いたり、連続で実行されたりすると、最新の数値を反映できないことがある。
- 【対策】関数型アップデートを使う このように書き換えると「現在の最新の値」から確実に1を引くようになる

```js

if (targetTodo.checked) {
  setCompleteCount(prev => prev - 1);
} else {
  setIncompleteCount(prev => prev - 1);
}
```
- この prev はReactというシステム側が、自動的に「現在の最新のステート値」を入れて届けてくれる引数

```js
setCompleteCount(completeCount - 1);
```
* 意味: 「今この瞬間に私が見えている completeCount という変数から 1 を引いてね」という命令。
* 弱点: ボタンを連打したり、複数の処理が重なると、JavaScriptの実行タイミングのズレで「古い値」を基準に計算してしまうことがあります（これが数値が合わない原因になることが多いです）。
prev を使った書き方（関数型アップデート）
```js

setCompleteCount((prev) => {
  return prev - 1;
});
```
* 意味: 「今の本当の最新値がいくらであれ、その値（prev）から 1 を引いたものを新しい値にしてね」という命令。

2. なぜ定義していない prev に値が入るのか？
これは 「コールバック関数」 という仕組み
setCompleteCount の中に「関数」を放り込むと、Reactは下記のように動く
1. React：「お、関数が渡されたな。今の最新のステート値を準備しよう」
2. React：「よし、準備できた。この最新値を、関数の最初の引数として中に入れて実行してあげよう」
3. この時、引数の名前に prev（previousの略）と名付けて受け取っているだけ
なので、名前は p でも state でも currentCount でも何でも動く

```js

// これでも全く同じ動き
setCompleteCount(currentValue => currentValue - 1);
```

- 1. 省略しない（フルスペックの）書き方
まずは、一切の省略をせずに書く
```JavaScript

const completeCount = todoList.filter(function(t) {
  return t.checked === true;
}).length;
```
ここから、以下のステップで今の形に進化

2. どうやって省略されているのか？
① function キーワードの省略
function(t) { ... } を、=>（アロー）を使って書き換え
```JavaScript

(t) => { return t.checked === true; }
```
② () === true の省略
t.checked 自体が true か false を持っているので、わざわざ === true と書かなくても、そのまま条件として使える
```JavaScript

(t) => { return t.checked; }
```
③ return と {} の省略（ここが重要！）
アロー関数の中身が1行だけで、その値を返したいときは、{} と return をセットで消すことができる
```JavaScript

(t) => t.checked
```
④ 引数のカッコ () の省略
引数がちょうど1つのときは、カッコも消せる
```JavaScript

t => t.checked
```
3. 完成形
これらをすべて組み合わせると、あなたの見たあの1行に
```JavaScript

todoList.filter(t => t.checked).length;

```
useStateの初期値に関して
* リストを作りたい: 空配列 []
* ON/OFFを切り替えたい: false
* 「どれか1つ」を選びたい: -1（数値）
* 名前や文章を入れたい: ""（空文字）


## 次やること
- todoListの振り返りとビジュアルを整える


## 感じたこと
- useStateをまずは完璧にしたい

## 学習時間
- 7.1h
