## 取り組んだ課題一覧  
- Django_教科書
- 公式チュートリアル

## わかったこと
## クイックインストールガイド

**Pythonインストール確認**
```python:Python
python3 --version
Python 3.13.6
```
**Django_tutorial作成**
```bash:Python
mkdir Django_tutorial

cd Django_tutorial
```

python3 -m venv tutorial

source tutorial/bin/activate



## ◆はじめてのDjangoアプリ作成、その１

**Pollアプリケーション構成**
- ユーザが投票したり結果を表示したりできる公開用サイト
- 投票項目の追加、変更、削除を行うための管理 (admin) サイト

**Djangoインストール**

```python:Django_tutorial
pip3 install "Django==4.2.*"
Collecting Django==4.2.*
  Using cached django-4.2.24-py3-none-any.whl.metadata (4.2 kB)
Collecting asgiref<4,>=3.6.0 (from Django==4.2.*)
  Using cached asgiref-3.9.2-py3-none-any.whl.metadata (9.3 kB)
Collecting sqlparse>=0.3.1 (from Django==4.2.*)
  Using cached sqlparse-0.5.3-py3-none-any.whl.metadata (3.9 kB)
Using cached django-4.2.24-py3-none-any.whl (8.0 MB)
Using cached asgiref-3.9.2-py3-none-any.whl (23 kB)
Using cached sqlparse-0.5.3-py3-none-any.whl (44 kB)
Installing collected packages: sqlparse, asgiref, Django
Successfully installed Django-4.2.24 asgiref-3.9.2 sqlparse-0.5.3
```

**インストール確認**
```python:Django_tutorial
python3 -m django --version 
4.2.24
```

#### いったんDjangoフレームワークの仕組みを理解をする

#### プロジェクトを作成する

```bash:Django_tutorial
django-admin startproject mysite
```

- 実行すると次のような構造が作られる

```
mysite/
├── manage.py
└── mysite/
    ├── __init__.py
    ├── settings.py
    ├── urls.py
    ├── asgi.py
    └── wsgi.py
```
- `mysite` : プロジェクトのフォルダ。名前はなんでもいいがこの後のチュートリアル通りに進めるなら変えないのが無難。
- `manage.py` : Djangoプロジェクトを作成すると自動生成される管理用スクリプトです。このファイルを通して、サーバーの起動やマイグレーション、管理コマンドの実行などを行う。Djangoが用意している機能をまとめて呼び出すための「入口（ランチャー）」のようなものです。


**よく使う管理コマンド**
```python
# 開発サーバーを起動
python3 manage.py runserver

# モデルの変更を検知してマイグレーションファイルを作成
python3 manage.py makemigrations

# マイグレーションをDBに反映
python3 manage.py migrate

# Djangoシェルを起動（DB操作や動作確認に使う）
python3 manage.py shell

# 管理ユーザーを作成
python3 manage.py createsuperuser
```

- `mysite/__init__.py` : このディレクトリがPythonパッケージであることをpythonに伝えるための空ファイル。
- `mysite/settings.py` : Djangoプロジェクトの設定ファイル。

- `mysite/urls.py`: Django プロジェクトの URL 宣言、いうなれば Django サイトにおける「目次」に相当します。

- `mysite/asgi.py` : プロジェクトを提供する ASGI 互換 Web サーバーのエントリポイント

- `mysite/wsgi.py` : プロジェクトをサーブするための WSGI 互換 Web サーバーとのエントリーポイント

## 開発用サーバー

mysiteディレクトリに移動
```bash:Django_tutorial
cd mysite
```

サーバーを立ち上げる
```python:Django_tutorial/mysite
python3 manage.py runserver
Watching for file changes with StatReloader
Performing system checks...

System check identified no issues (0 silenced).

You have 18 unapplied migration(s). Your project may not work properly until you apply the migrations for app(s): admin, auth, contenttypes, sessions.
Run 'python manage.py migrate' to apply them.
September 27, 2025 - 03:46:12
Django version 4.2.24, using settings 'mysite.settings'
Starting development server at http://127.0.0.1:8000/
Quit the server with CONTROL-C.

[27/Sep/2025 03:46:29] "GET / HTTP/1.1" 200 10664
```

デフォルトでは runserver コマンドは内部 IP のポート 8000 で起動します。

`http://127.0.0.1:8000/` で確認

![スクリーンショット 2025-09-27 12.48.52.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/4070526/7e1580d1-1725-4976-a2ca-89f8bc7cd344.png)

**サーバーのポートを変えたい場合**

```python:Django_tutorial/mysite
python3 manage.py runserver 8080
```

**サーバのIPを指定するとき**

```python:Django_tutorial/mysite
python3 manage.py runserver 0.0.0.0:8000
```

## Pollsアプリケーションを作る
**アプリの構造を作成**
```python:Django_tutorial/mysite
python3 manage.py startapp polls
```

ポイント：`manage.py` と同じディレクトリで実施する

**作成されたアプリのディレクトリ構成**
```
Django_tutorial/
 ├── mysite/        ← プロジェクト本体（設定）
 │    ├── settings.py
 │    ├── urls.py
 │    └── ...
 ├── plls/                ← pollsアプリ
 │    ├── __init__.py     
 │    ├── admin.py
 │    ├── apps.py
 │    ├── migration.py
 │    │    └──__init__.py
 │    ├── models.py
 │    ├── tests.py
 │    └── views.py
```

### はじめてのビュー作成
```bash:Django_tutorial
code mysite
```
```python:polls/views.py
from django.shortcuts import render

# Create your views here.
from django.http import HttpResponse


def index(request):
    return HttpResponse("Hello, world. You're at the polls index.")

```
>HttpResponseをインポートする
requestを受け取ったらHello, world. You're at the polls index.という文字列を返す
- **request**：Django が **リクエストごとに生成**する `HttpRequest` **インスタンス**（情報の入れ物）。

型：django.http.HttpRequest

生成：ブラウザからのアクセスごとに 1リクエスト＝1インスタンス を Django が作成

役割：そのアクセスに関するあらゆる情報をまとめてビューへ渡す“コンテナ”
- よく使う `request` 情報
```py
request.method            # "GET", "POST" など
request.GET               # クエリ文字列 (/polls/?page=2 → {"page": "2"})
request.POST              # フォームデータ
request.headers           # ヘッダ
request.COOKIES           # クッキー
request.user              # 認証ユーザー（auth 使用時）
request.session           # セッション
request.path              # "/polls/"
request.build_absolute_uri()  # "http://127.0.0.1:8000/polls/"
```

- **response**：ビューが返す `HttpResponse`（ブラウザへ戻る内容）。

実行フロー
1) ブラウザが `GET /polls/?page=2` へアクセス  
2) ASGI/WSGI サーバ経由で Django へ  
3) Middleware を通過  
4) `urls.py` で URL パターンにマッチ → 対応ビューを決定  
5) その時点の情報で **`HttpRequest` インスタンスを生成**（＝`request`）  
6) ビューに `request`（＋URLパラメータなど）を渡す  
7) ビューが `HttpResponse` を返却 → ミドルウェアを逆順に通過 → ブラウザへ


urls.pyを作成する

```
Django_tutorial/
 ├── mysite/ 
 │    ├── settings.py
 │    ├── urls.py
 │    └── ...
 ├── plls/               
 │    ├── __init__.py     
 │    ├── admin.py
 │    ├── apps.py
 │    ├── migration.py
 │    │    └──__init__.py
 │    ├── models.py
 │    ├── tests.py
 │    ├── urls.py 　　　　← 新規作成！！
 │    └── views.py
```

polls ディレクトリに URLconf を作るには urls.py に下記を記述する

```python:polls/urls.py
from django.urls import path

from . import views

urlpatterns = [
    path("", views.index, name="index"),
]

```
views.index
→ そのURLに来たとき実行する ビュー関数。
つまり「/polls/ に来たら views.index を呼ぶ」。

name="index"
→ このURLに 名前 を付ける。
逆引きで使える（reverse("polls:index") や {% url 'polls:index' %} で /polls/ を生成）。/polls/ にアクセスが来たら views.index を実行する。その経路名は index
※ polls/urls.py に app_name = "polls" を書いていると経路名がpolls:indexになる


```python:mysite/urls.py
from django.contrib import admin
from django.urls import include, path

urlpatterns = [
    path("polls/", include("polls.urls")),
    path("admin/", admin.site.urls),
]
```

polls/ にマッチしたら polls アプリの urls.py に処理を委譲。
includeの役割＝「この先は polls アプリ内で細かい道案内をしてね」という案内所。


```python:
python3 manage.py runserver
```

![スクリーンショット 2025-09-27 13.33.11.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/4070526/f996e131-90f8-4a14-ada4-6fc2135c44b9.png)

## ◆はじめてのDjangoアプリ作成、その２

### Database の設定

```python:mysite/settings.py(標準仕様)

DATABASES = {
    "default": {
        "ENGINE": "django.db.backends.sqlite3",
        "NAME": BASE_DIR / "db.sqlite3",
    }
}

```
**ENGINE**
- どのDBを使うかを指定

```python:mysite/settings
    'django.db.backends.sqlite3'    # SQLite
    'django.db.backends.postgresql' # PostgreSQL
    'django.db.backends.mysql'      # MySQL / MariaDB
    'django.db.backends.oracle'     # Oracle
```
- 外部ライブラリを使えば他のDBも利用可能

**NAME**
- DBの名前や場所を指定
- SQLite の場合：
    NAME = BASE_DIR / 'db.sqlite3'
    → プロジェクト直下にファイルが作られる
- PostgreSQL / MySQL / Oracle の場合：
    NAME = 'mydatabase'
    → DBサーバーに存在するDB名を指定
    → USER / PASSWORD / HOST / PORT も必要

```sql:PostgreSQL
DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.postgresql',
        'NAME': 'mydb',
        'USER': 'myuser',
        'PASSWORD': 'mypassword',
        'HOST': 'localhost',
        'PORT': '5432',
    }
}
```


**BASE_DIR**

- **BASE_DIR** = プロジェクトの**基準ディレクトリを指す絶対パス**
- これ自体が場所を登録するのではなく、**各設定（TEMPLATES/STATIC/MEDIA/DB など）でパスを組み立てるための出発点**として使う


**どこを指す？**
通常は **`manage.py` がある階層**（プロジェクトのルート）
```
Django_tutorial/   ← ここが BASE_DIR  
├─ manage.py  
├─ db.sqlite3  
├─ templates/  
├─ static/  
└─ mysite/  
　├─ settings.py  
　├─ urls.py  
　└─ wsgi.py / asgi.py  
```
**TIME_ZONE**
TIME_ZONE = "Asia/Tokyo"

```python:mysite/settings.py
INSTALLED_APPS = [
    "django.contrib.admin",
    "django.contrib.auth",
    "django.contrib.contenttypes",
    "django.contrib.sessions",
    "django.contrib.messages",
    "django.contrib.staticfiles",
]
```
**INSTALLED_APPS**
- **このプロジェクトで“有効化するアプリの登録簿”**
- ここに列挙されたアプリだけが Django に読み込まれ、各機能が反映される

**Django 標準アプリ**

**admin**
- /admin/ で使える管理サイト。モデルを登録するとCRUD UIが自動生成。
- 使うには mysite/urls.py に path("admin/", admin.site.urls) が必要。
- 依存：auth, contenttypes。

**auth**
- ユーザー認証・権限。User/Group/Permission モデル、パスワードハッシュ化、ログイン/ログアウト view など。
- request.user を提供（Middlewareが必要）。
- “認可”は user.has_perm("app.codename") / user.is_staff / user.is_superuser などで判定。

**contenttypes**
- どのアプリのどのモデルかを汎用的に識別する仕組み（ContentType）。
- 権限や汎用外部キー（GenericForeignKey）で使われる“基盤”。
- ほぼ外せない土台。単体で直接触る機会は少なめ。

**sessions**
- セッション管理。request.session["key"] = "value" のようにユーザーごとデータ保持。
- デフォルトはDBセッション（テーブル django_session）。Redis 等への切り替えも可。
- ログイン状態維持にも使われることが多い。

**messages**
- フラッシュメッセージ（1回きりの通知）を扱う。
- 例：
  from django.contrib import messages
  messages.success(request, "保存しました")  # 次のレスポンスで1回だけ表示
- 表示にはテンプレートタグ {% for message in messages %} と Middleware/コンテキストプロセッサが必要（デフォルト有効）。

**staticfiles**
- 静的ファイル（CSS/JS/画像）の探索と配信（開発サーバ用）、本番配信用の collectstatic を提供。
- 典型コマンド：python manage.py collectstatic
- テンプレートで {% load static %} → <link href="{% static 'app/style.css' %}">

**アプリ / モデル / テーブル の関係**

- **モデル = テーブルの設計図**
  - `models.Model` を1つ定義 → 通常はテーブル1つ作成
  - ManyToManyは中間テーブルも自動追加

- **アプリ = 機能の入れ物**
  - 1アプリにモデルは **0個でも複数でもOK**
  - モデル“があるアプリ”だけDBテーブルが増える
  - モデル不要のアプリ（APIだけ、外部連携だけ等）も **あり得る**

- **INSTALLED_APPS に登録すると**
  - そのアプリのモデルが **migrate対象** になる
  - admin/テンプレ/static/ready() など **アプリの提供物が有効化**

```python:Django_tutorial/mysite
python3 manage.py migrate
Operations to perform:
  Apply all migrations: admin, auth, contenttypes, sessions
Running migrations:
  Applying contenttypes.0001_initial... OK
  Applying auth.0001_initial... OK
  Applying admin.0001_initial... OK
  Applying admin.0002_logentry_remove_auto_add... OK
  Applying admin.0003_logentry_add_action_flag_choices... OK
  Applying contenttypes.0002_remove_content_type_name... OK
  Applying auth.0002_alter_permission_name_max_length... OK
  Applying auth.0003_alter_user_email_max_length... OK
  Applying auth.0004_alter_user_username_opts... OK
  Applying auth.0005_alter_user_last_login_null... OK
  Applying auth.0006_require_contenttypes_0002... OK
  Applying auth.0007_alter_validators_add_error_messages... OK
  Applying auth.0008_alter_user_username_max_length... OK
  Applying auth.0009_alter_user_last_name_max_length... OK
  Applying auth.0010_alter_group_name_max_length... OK
  Applying auth.0011_update_proxy_permissions... OK
  Applying auth.0012_alter_user_first_name_max_length... OK
  Applying sessions.0001_initial... OK
```
**`INSTALLED_APPS` に入っていて、公式の *migrations* を同梱しているアプリ**のテーブルが**一気に作成**される 



### モデルの作成

- **アプリ内でデータ構造と振る舞いを定義する“テーブルの設計図”**（Pythonクラス）。
- `django.db.models.Model` を継承して作成。**通常は1モデル=DBテーブル1つ**（多対多は中間テーブル追加）。

```python:polls/models.py
from django.db import models


class Question(models.Model):
    question_text = models.CharField(max_length=200)
    pub_date = models.DateTimeField("date published")


class Choice(models.Model):
    question = models.ForeignKey(Question, on_delete=models.CASCADE)
    choice_text = models.CharField(max_length=200)
    votes = models.IntegerField(default=0)
```
**コード解説**
```python:polls/models.py
class Question(models.Model):
    question_text = models.CharField(max_length=200)
    pub_date = models.DateTimeField("date published")
```
- `Question` は「質問」テーブルの設計図（= モデル）。
- `question_text = models.CharField(max_length=200)`
　↪︎models.pyモジュールのCharFieldクラスを呼び出して設定。文字列カラム。最大200文字の制約（DBレベル/バリデーション）。
- `pub_date = models.DateTimeField("date published")`
↪︎日時カラム。括弧内は `verbose_name`（管理画面などでの表示名）。

```polls/models.py
class Choice(models.Model):
    question = models.ForeignKey(Question, on_delete=models.CASCADE)
    choice_text = models.CharField(max_length=200)
    votes = models.IntegerField(default=0)
```
- Choice は「選択肢」テーブルの設計図。
- question = models.ForeignKey(Question, on_delete=models.CASCADE)
↪︎models.pyモジュールのForeignKeyクラスを呼び出して設定。外部キーで Question と 多対一（Choice 多 : 1 Question）を表現。
on_delete=models.CASCADE は 親（Question）が削除されたら子（Choice）も一緒に削除の意味。
- choice_text = models.CharField(max_length=200)
選択肢の本文。
- votes = models.IntegerField(default=0)
票数。デフォルト0でレコード作成時に未指定でも0が入る。


**Djangoモデル定義の要点**

**1 : モデル定義**
- `models.Model` を継承した **Pythonクラス**を作る = テーブル名になる(設計図)
- クラス内の **属性に Field を置く**（`CharField`, `IntegerField`, `ForeignKey` など）
  → それぞれ **DBの列**になる

**2 : テーブル間の連携（リレーション）**
- **1対多**：`ForeignKey(Parent, on_delete=...)`  
- **多対多**：`ManyToManyField(Other)`（中間テーブル自動生成）  
- **1対1**：`OneToOneField(Other)`
- 逆参照は `related_name` を付けると読みやすい（`parent.children.all()` など）

### モデルを有効にする

- アプリ (例: polls) を作成しただけでは、まだプロジェクトに認識されていない
- DBスキーマ作成や API 利用をするには「プロジェクトにアプリを登録」する必要がある

```python:mysite/settings.py
INSTALLED_APPS = [
    "polls.apps.PollsConfig",
    "django.contrib.admin",
    "django.contrib.auth",
    "django.contrib.contenttypes",
    "django.contrib.sessions",
    "django.contrib.messages",
    "django.contrib.staticfiles",
]
```

```python:Django_tuutorial/mysite
python3 manage.py makemigrations polls
Migrations for 'polls':
  polls/migrations/0001_initial.py
    - Create model Question
    - Create model Choice
```

**makemigrations**
- **makemigrations**：モデル変更を検知し、**マイグレーションファイル**（DBスキーマ変更の設計図）を作成  
  - 例: `polls/migrations/0001_initial.py`
  - 人間可読で、必要なら**手動で微調整**も可能
- **migrate**：作成済みマイグレーションを**実行**し、DBスキーマに反映
- **sqlmigrate**：あるマイグレーションが**どんなSQLを実行するかを表示**
- **showmigrations**：適用/未適用の一覧を表示

```python:Django_tutorial/mysite
python3 manage.py migrate
Operations to perform:
  Apply all migrations: admin, auth, contenttypes, polls, sessions
Running migrations:
  Applying polls.0001_initial... OK
```

【マイグレーションとは】
- Django の「データベース変更管理ツール」
- models.py を変更しても、DBを作り直さずに反映できる
- データを失わずにテーブル構造をアップデート可能

【3ステップの流れ】
1. モデルを変更する
   → models.py にフィールド追加・修正など

2. マイグレーションファイルを作成する
   → コマンド: python manage.py makemigrations
   → 変更内容が migrations/ に記録される

3. データベースへ適用する
   → コマンド: python manage.py migrate
   → DBのテーブル構造が更新される

【ポイント】
- DBやテーブルを削除・再作成する必要なし
- データを保持したまま安全に変更できる
- 実際の開発では何度も繰り返し使う基本ワークフロー

## 次やること
- Django_公式チュートリアル
- Django_教科書

## 感じたこと
- 起床が遅くなっていつもであれば今日はいいかと思ってしまうけど目標の200時間をかかげていたので8.00h勉強することができた。
- 毎日8時間以上やるのはコスパが悪いと感じる

## 学習時間
- 8.00h
