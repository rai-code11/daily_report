## 取り組んだ課題一覧  
- Django_公式チュートリアル

## わかったこと
### Djangoフォームの役割
1. ユーザー入力データを保持  
   - request.POST/GETをFormインスタンスにまとめる  
   - cleaned_dataから安全に取得  

2. 入力データのバリデーション  
   - 必須・型・長さなどを自動チェック  
   - is_valid() → form.errors  

3. HTML出力（フォーム要素＋エラーメッセージ）  
   - {{ form }} / {{ form.as_p }} で自動生成  
   - 入力値保持＋エラー表示  

4. セキュリティ対策  
   - CSRFトークン自動付与  
   - 不正入力(XSS等)を無害化  

---

### Djangoフォームのバリデーションの流れ

1. フィールドレベルのバリデーション（各フィールドごと）
   - to_python() : 入力値をPythonオブジェクトへ変換
       例: "123" → int(123)
   - validate() : 必須チェックやフィールド固有の検証
       例: EmailFieldの形式チェック
   - run_validators() : validators=[...] に定義した独自チェック
   → OKなら cleaned_data に格納される

2. フォームレベルのバリデーション（フォーム全体）
   - clean_<field>() : 特定フィールドに対する追加検証
       例: パスワードが「admin」ならエラー
   - clean() : 複数フィールドの整合性チェック
       例: 「開始日 < 終了日」かを確認
   → clean() の戻り値が cleaned_data を最終的に置き換える
      （ここで加工・追加・修正が可能）

**ポイント**
- cleaned_data は「検証済みの安全なデータ」の辞書
- clean() を使うとフォーム全体の整合性チェックに加え、
  値の加工や整形もできる（戻り値で cleaned_data を上書きするため）

---

### forms.py の役割

**フォームの定義**  
- 「どんな入力欄を作るか」を Python で定義する場所  
- 例: ユーザー登録フォーム（名前・メール・パスワード）  
       ログインフォーム（ユーザー名・パスワード）  
       問い合わせフォーム（名前・メール・内容）  
       検索フォーム（キーワード）  

**入力データのバリデーション**  
- 必須チェック、文字数制限、メール形式チェック  
- 独自ルールも追加可能（例: password と password2 が一致しているか）  
- is_valid() で検証し、OKなら cleaned_data に安全に格納される  

**データ処理（保存 or 他の処理）**  
- ModelForm：入力内容をそのままDBに保存可能（例: ユーザー登録）  
- 普通のForm：DBに保存しない処理にも使える（例: 問い合わせメール送信、外部API呼び出し）  

---

### 新規登録画面を例にすると
- forms.py → 「名前・メール・パスワード入力欄＋バリデーション」を定義  
- views.py → フォームを受け取り、is_valid() を実行し、OKならユーザーを保存  
- templates/ → 実際の入力画面（HTMLフォームを表示し、エラーも出す）  

つまり「入力 → 精査 → 登録」という流れ。  
ただし新規登録に限らず、ログインや問い合わせなどユーザー入力がある処理全般に使える。  


### Django アプリケーションの仕組み

**1. クライアントからのリクエスト**
- Webブラウザから「URL付きのHTTPリクエスト」が送られる
- 例: GET /products/10/

**2. URLディスパッチャ（urls.py）**
- プロジェクト直下の urls.py が最初に受け取り、どのアプリに振り分けるか決める
- アプリ内の urls.py がさらに解析し、どのビューを呼ぶかを特定する

**3. ミドルウェア**
- リクエストがビューに届く前に共通処理を行う
- 認証・セッション・CSRFチェック・ログ出力など
- レスポンスが返るときも同様に通過する（入口と出口のフィルター）

**4. ビュー（views.py）**
- 実際の処理を行う中心部分
- 必要に応じて以下とやり取りする
  - **フォーム（forms.py）** : 入力データの検証（is_valid → cleaned_data）
  - **モデル（models.py）** : ORMを使ってDBからデータ取得・保存
  - **テンプレート（templates/）** : contextデータを埋め込みHTMLをレンダリング
- 最終的に **HttpResponse（HTMLやJSONなど）** を作成する

**5. レスポンスの返却**
- ビューが作った HttpResponse は、再びミドルウェアやURLディスパッチャを経由してクライアントへ戻る
- ブラウザに完成したHTMLやAPIのJSONが表示される

**ポイントまとめ**
- **URLディスパッチャ** = 入り口のルーター（どのビューに渡すか決める）
- **ビュー** = 処理の司令塔（フォーム・モデル・テンプレートと連携し、レスポンスを作る）
- **ミドルウェア** = 入り口と出口で共通処理を差し込むフィルター
- **レスポンス** = ビューが作り、Django内部を通ってクライアントに返る

---

### ミドルウェアに書く処理の整理

** OKな処理（軽い共通処理） **
- 認証状態の確認（例: request.user をセット）
- セッション管理（Cookie と DB/キャッシュのひも付け）
- CSRF トークンの検証
- 全リクエスト/レスポンスのログ記録
- セキュリティヘッダの付与（X-Frame-Options など）
- 全ページ共通の軽いフラグチェック（例: サイトメンテナンス中かどうか）
  → この場合でもキャッシュや遅延評価を利用するのが望ましい

**NGな処理（重い処理）**
- 毎回の DB アクセスを伴う処理（例: 全ユーザーを取得する）
- 複雑なクエリ実行や集計
- 外部 API へのリクエスト
- 大量のファイル処理や I/O 負荷の高い処理



**ポイント**
- ミドルウェアは **「全リクエスト・全レスポンスに必ず通るフィルター」**  
- 基本は軽量処理に徹する  
- どうしてもDBが必要なら **キャッシュ** や **SimpleLazyObjectによる遅延評価** を活用して最小限に抑える  

### 静的ファイルと静的でないファイルの違い（メモ）

**静的ファイル（Static）**
- 定義：サーバーで計算せず、そのまま配る“素材”ファイル
- 例：CSS / クライアントJS / 画像（ロゴ等） / フォント / favicon / manifest / robots.txt
- 特徴：全ユーザーほぼ同一内容・変更頻度は低め・CDN/キャッシュと相性が良い
- Django：STATIC_URL / STATICFILES_DIRS / STATIC_ROOT、`{% static %}` で参照

**静的ではないもの（Dynamic）**
- **テンプレート（templates）**  
  - 定義：HTMLの雛形。サーバーでデータを埋めてから返す  
  - 例：商品一覧ページ、カート表示ページ  
  - Django：`render(request, "xxx.html", context)`
- **ユーザーアップロード（MEDIA）**  
  - 定義：ユーザーが後から保存するファイル（内容はユーザーごとに異なる）  
  - 例：プロフィール画像、投稿画像、添付ファイル  
  - Django：MEDIA_URL / MEDIA_ROOT（STATICと分離）
- **APIレスポンス**  
  - 定義：毎回サーバーが生成するデータ  
  - 例：JSONで返す検索結果、在庫数、ログイン状態など
- **ビジネスロジック結果**  
  - 例：カートの中身、注文合計、ログインユーザー情報  
  - 生成元：views（＋models/forms）で都度計算・取得

**見分け方（要点）**
- 同じURLでいつも同じ中身か？ → はい＝静的 / いいえ＝動的  
- サーバーでデータを埋めたり計算したりするか？ → する＝動的  
- ユーザーや時刻で中身が変わるか？ → 変わる＝動的  
- ファイルとして事前に置いておけるか？ → 置ける＝静的

**使い分けの結論**
- STATIC＝配布用の“固定素材”（CSS・クライアントJS・画像・フォント等）
- MEDIA＝ユーザーがアップする“後から増えるもの”（保存先・URLはSTATICと別）
- TEMPLATES / API / ビューの出力＝“その場で生成する”動的コンテンツ

## 次やること
- Django_公式チュートリアルの徹底解説

## 感じたこと
- 他人と比べてとかではなく自分の生き方に誇りを持つことが大切。
- 自分のやりたいことのために成長して金を稼ぐ。自分がなりたい姿を想像してそのために愚直に取り組む。

## 学習時間
- 8.15h
