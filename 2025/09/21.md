## 取り組んだ課題一覧  
- REST_記事作成
- Django_udemy

## わかったこと
9月21日


REST記事の装飾
Django 30 ~40
まとめながら日報を書く

14231615.  112
16501800.  70
18452000.  75
21002114.  14
21422254.  72
23060035. 89
01460216.   30


### Django: TemplateViewでHTMLを表示する手順

#### 1. views.py
Djangoが用意している **`TemplateView` クラス** を継承してビューを作成する。  
`template_name` という属性に表示したいテンプレートファイルの名前を指定することで、そのHTMLを返せる。

```python
from django.views.generic import TemplateView

# TemplateViewを継承したクラスベースビュー
class HelloWorldView(TemplateView):
    # このテンプレートが描画される
    template_name = "hello.html"
```


#### 2. settings.py
Djangoはテンプレートを探す場所を `TEMPLATES` 設定で決めている。  

- `DIRS` : Djangoがテンプレートを探す追加パスをリストで指定する。  
  → ここに `BASE_DIR / "templates"` を指定することで、**プロジェクト直下の templates フォルダ**からHTMLを読み込めるようになる。  
- `APP_DIRS` : 各アプリの `templates` フォルダを自動的に読み込むかどうかの設定（True にするのが一般的）。

```python
TEMPLATES = [
    {
        "BACKEND": "django.template.backends.django.DjangoTemplates",
        # templates フォルダを検索対象に追加
        "DIRS": [BASE_DIR / "templates"],
        "APP_DIRS": True,  # 各アプリ内の templates フォルダも自動で読み込む
        "OPTIONS": {
            "context_processors": [
                "django.template.context_processors.debug",
                "django.template.context_processors.request",
                "django.contrib.auth.context_processors.auth",
                "django.contrib.messages.context_processors.messages",
            ],
        },
    },
]
```


#### 3. ディレクトリ構成
`manage.py` と同じ階層に `templates` フォルダを作成し、その中に `hello.html` を置く。  
これにより、`template_name = "hello.html"` が正しく参照される。  

```text
myproject/
│ manage.py
│ db.sqlite3
│ ...
├─ myapp/
│   ├─ views.py   ← ビューを定義
│   └─ urls.py    ← URLをルーティング
└─ templates/
    └─ hello.html ← 表示するHTMLファイル
```


#### 4. urls.py
ビュークラスをURLに関連付ける。  
クラスベースビューを使うときは **`.as_view()` メソッド**を必ず呼び出す。  
これはクラスをDjangoが使えるビュー関数に変換する仕組み

```python
from django.urls import path
from .views import HelloWorldView

urlpatterns = [
    # /hello/ にアクセスすると HelloWorldView が処理される
    path("hello/", HelloWorldView.as_view(), name="hello"),
]
```


#### 5. hello.html
実際に表示されるテンプレートファイル。  
HTMLの中にDjangoテンプレートタグ（`{{ }}` や `{% %}`）を埋め込むことで、  
Pythonから渡したデータを表示することもできる。今回は静的な例。

```html
<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>Hello</title>
</head>
<body>
  <h1>Hello, Django Template!</h1>
</body>
</html>
```


#### 6. 動作確認
サーバーを起動して `/hello/` にアクセスする。  
ビュークラスが呼ばれ、`hello.html` がブラウザに表示される。

```bash
python manage.py runserver
# ブラウザで http://127.0.0.1:8000/hello/ を開く
```


### DjangoのURLルーティングの仕組み

#### 1) リクエストが来る
- ユーザーが **`https://aaa.com/news/price`** にアクセスすると、まず **プロジェクト直下の `urls.py`** が参照される。


#### 2) プロジェクトの `urls.py`
```python
# myproject/urls.py
from django.urls import path, include

urlpatterns = [
    path("news/", include("news.urls")),  # newsアプリに振り分ける
]
```
- `news/` にマッチしたら **`news` アプリの `urls.py`** に処理を委譲。
- 役割＝「この先は news アプリ内で細かい道案内をしてね」という案内所。


#### 3) アプリの `urls.py`
```python
# news/urls.py
from django.urls import path
from . import views

urlpatterns = [
    path("price/", views.ViewA, name="price"),
]
```
- `price/` にマッチしたら **`ViewA`**（ビュー処理）を実行。
- ここで初めて「どのビューを動かすか」が決まる。


#### 4) 全体の流れ（`/news/price` の解釈）
1. ブラウザから `https://aaa.com/news/price` にアクセス  
2. **プロジェクト `urls.py`** が `news/` にマッチ → **`news.urls`** へ委譲  
3. **アプリ `news/urls.py`** が `price/` にマッチ → **`ViewA`** を実行  
4. **`ViewA`** がレスポンス（HTML/JSONなど）を返す  


#### 5) まとめ
- **プロジェクトの `urls.py`** → アプリごとの **入り口** を管理（`include()` で委譲）
- **アプリの `urls.py`** → 具体的な **URL ⇄ View** の対応を管理
- **URLは階層的に処理** される（上位プレフィックスで切り分け → アプリ内で詳細分岐）

---

### Django: モデルクラス `TodoModel` の解説

#### 1. モデルクラスとは
- Django ではデータベースのテーブルを **Python のクラス**として定義できる。  
- `models.Model` を継承したクラスが1つのテーブルになる。  
- クラスの中に書いた変数（フィールド）がテーブルのカラムになる。  


#### 2. 実際のコード
```python
from django.db import models

class TodoModel(models.Model):
    title = models.CharField(max_length=100)
    memo = models.TextField()
```


#### 3. 各部分の解説


class モデル名(models.Model):
    フィールド名 = models.フィールド型(オプション)

** `class TodoModel(models.Model):`**
- **クラス名: `TodoModel`**
  - このクラスがデータベースのテーブルを表す。  
  - デフォルトではテーブル名は **`アプリ名_todomodel`** になる（例: `helloworldapp_todomodel`）。  
- **`models.Model` を継承**
 - # models.Model の正体

- `models` は **Django の `django.db` にあるモジュール**。  
- その中に **`Model` クラス** が定義されている。  
- つまり **`models.Model` = 「models モジュールの中の Model クラス」** を指している。  
- Django に「これはデータベースモデルだ」と伝えるために必須。


**`title = models.CharField(max_length=100)`**
- **`CharField`** = 短い文字列を保存するフィールド。  
- `max_length=100` = 最大100文字まで保存可能。  
- DB上では `VARCHAR(100)` のようなカラムになるイメージ。  
- 例: ToDoのタイトル「買い物に行く」「勉強する」など。


**`memo = models.TextField()`**
- **`TextField`** = 長文を保存できるフィールド。  
- 制限文字数がほぼない（大量の文字列を格納可能）。  
- DB上では `TEXT` 型のカラムになるイメージ。  
- 例: ToDoの詳細メモ「スーパーで卵と牛乳を買う」など。

---

#### 4. このモデルから作られるテーブルのイメージ
Djangoでマイグレーションすると、次のようなテーブルが作られるイメージ。

```sql
CREATE TABLE helloworldapp_todomodel (
    id INTEGER PRIMARY KEY AUTOINCREMENT,  -- Djangoが自動で付ける主キー
    title VARCHAR(100) NOT NULL,
    memo TEXT NOT NULL
);
```



### Djangoでテーブルを作成するときにやるべき2つのこと

#### 1. makemigrations
- 役割: **モデルの変更内容をマイグレーションファイルに保存する**  
- 実際のDBをいじるのではなく、「これからこういうテーブルやカラムを作りますよ」という **設計書（マイグレーションファイル）** を生成する。  
- 過去の履歴が残るので、後で「どこで変更したか」を追える。  
- もしモデルの定義に不備があるときは、ここでエラー内容が表示される。

```bash
python manage.py makemigrations
```

実行例:
```bash
Migrations for 'helloworldapp':
  helloworldapp/migrations/0001_initial.py
    - Create model TodoModel
```

---

#### 2. migrate
- 役割: **マイグレーションファイルを実際のDBに反映する**  
- `makemigrations` で作られた設計書を読んで、SQLを自動で発行し、DBにテーブルやカラムを作成/変更する。  
- これで初めてデータベースにテーブルができる。

```bash
python manage.py migrate
```

実行例:
```bash
Operations to perform:
  Apply all migrations: admin, auth, contenttypes, helloworldapp, sessions
Running migrations:
  Applying helloworldapp.0001_initial... OK
```


### Django: `python3 manage.py createsuperuser` の解説

#### 1. 役割
- Django の **管理画面（adminサイト）にログインできる特別なユーザー** を作成するコマンド。  
- 「スーパーユーザー」と呼ばれ、すべてのデータの追加・編集・削除が可能。  

---

#### 2. 実行方法
ターミナルで以下を実行する。

```bash
python3 manage.py createsuperuser
```

---

#### 3. 実行時に聞かれること
順番に入力していく。

```
Username: admin        ← ログイン時に使うユーザー名
Email address: a@a.com ← メールアドレス
Password: ********     ← パスワード
Password (again): **** ← パスワード再入力
```

---

#### 4. 完了後の使い方
1. 開発サーバーを起動  
   ```bash
   python3 manage.py runserver
   ```
2. ブラウザで管理画面にアクセス  
   ```
   http://127.0.0.1:8000/admin/
   ```
3. 作成したユーザー名とパスワードでログイン  
   → Django の管理画面からモデルデータを操作できるようになる。


### DjangoのCRUDと汎用ビューの対応関係

#### Create（作成）
- **汎用ビュー**: `CreateView`  
- 役割: 新しいデータを入力フォームから作成してDBに保存する。  
- テンプレート例: `create.html`  

---

#### Read（読み取り）
- **一覧表示**: `ListView`  
  - 役割: モデルのすべてのデータを一覧表示する。  
  - テンプレート例: `list.html`  
- **詳細表示**: `DetailView`  
  - 役割: 1件のデータの詳細を表示する。  
  - テンプレート例: `detail.html`  

---

#### Update（更新）
- **汎用ビュー**: `UpdateView`  
- 役割: 既存データを取得してフォームに表示し、編集して保存する。  
- テンプレート例: `update.html`  

---

#### Delete（削除）
- **汎用ビュー**: `DeleteView`  
- 役割: データを削除する。通常は「本当に削除していいですか？」確認ページを挟む。  
- テンプレート例: `delete.html`  





## 次やること
- Django_udemy

## 感じたこと
- RESTが終わった後ですぐDjangoで覚えることが多いが集中して取り組んでいく。
- これまで学んだことの復習問題をやったが、基礎は理解できていることがわかった。ただ、応用は抜けている部分が多かったので復習していきたい。

## 学習時間
- 7.70h
