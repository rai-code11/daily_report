## 取り組んだ課題一覧  
- REST

## わかったこと
### Web APIとは

**Web API（Web Application Programming Interface）** とは、  
インターネット経由でシステム同士がやり取りできる「窓口（インターフェース）」のことです。  
「Web」を通してデータや機能を提供・利用できる仕組みだと考えるとイメージしやすいです。  

---

### イメージ例

#### レストランの注文
- お客さん（あなた）は「カレーください」と注文する。  
- 店員（API）が厨房（サーバー）に伝えて料理を持ってくる。  
- お客さんは厨房の中身を知らなくても、決められた注文方法で料理を得られる。  

→ APIも同じで、「リクエスト」を送ると「レスポンス」が返ってくる。  


### Web API = お客さんと厨房の橋渡し

- **お客さん（利用者）**  
  「カレーください」「今日の天気教えて」みたいに注文する（リクエストを送る）

- **店員（API）**  
  注文を正しい形に整えて、厨房（サーバー）に伝える

- **厨房（サーバー）**  
  注文を処理して、料理（情報や結果）を用意する

- **店員（API）が料理を運んでくる**  
  サーバーから受け取った結果を、お客さんに返す（レスポンス）

---

### できること

- **サーバーにある情報を持ってくる（取得）**  
  例: 天気予報、地図情報、口コミデータなど

- **サーバーに新しい情報を送る（登録）**  
  例: 投稿を作る、アカウントを登録する

- **サーバーの情報を変える（更新・削除）**  
  例: プロフィールを編集する、注文をキャンセルする

---

### まとめ

- Web APIは「橋渡し」だから、  
  - サーバーの中にある情報を持って来れる  
  - 新しい情報をサーバーに送れる  


### 第三者とAPIの関係

- **元の店（本家サービス）**  
  - 店員（API）が厨房（サーバー）とやり取りして料理（データ）を提供する  

- **第三者（外部の開発者）**  
  - 本家の店員（API）を「雇う（＝利用する）」  
  - その店員に注文（リクエスト）を伝えると、厨房から料理（情報）を持ってきてくれる  
  - 結果、自分の店（アプリ）でも同じ料理（データや機能）を出せる  

---

### 具体例

- **ぐるなびAPI**  
  - 本家ぐるなび（飲食店サイト）が店員（API）を公開  
  - 第三者アプリがその店員を雇い  
  - 「渋谷の居酒屋情報」を取得して、自分のアプリに表示できる  

- **Google Maps API**  
  - Googleが店員（API）を公開  
  - 第三者（不動産サイト）がその店員を雇い  
  - 地図情報を借りて、自分のサイトに「物件の場所」を表示できる  

---

### まとめ

- 第三者は **APIを通じてデータや機能を利用できる**  
- 厨房（データベース）に直接入ることはできない  
- 店員（API）を使って料理（情報）を持ってきてもらい、自分のサービスに組み込める  



### APIのポイント

- **API自体が「機能」を持っている**  
  - Google Maps API → 地図を表示する機能  
  - Twitter API → ツイートを取得・投稿する機能  
  - ぐるなびAPI → 飲食店情報を返す機能  

- **第三者はその機能を“借りて使う”**  
  - 自分で一から地図を作ったり  
  - お店のデータを集めたり  
  → する必要がない  

- **結果として**  
  - 自分のアプリやサイトを、APIの力でより便利にできる  

---

### まとめ

- **API = 便利な機能の外部レンタル窓口**  
- 第三者はその機能を借りて、自分のサービスを強化できる  


### API公開の注意点

- **なんでも無条件に公開していいわけではない**  
  - 公開するのは「公開しても問題ないデータ・機能」に限定する必要がある  

---

### 一番の問題
- **入るはずの利益が入らなくなること**

#### 具体的なリスク
- **ユーザーが減る**  
  → 他サービスが自分のデータを使って、より便利なアプリを作り、ユーザーが流れてしまう  

- **リソースが圧迫される**  
  → API経由で大量アクセスが来て、サーバーに負担がかかる  

- **データが盗まれる**  
  → 公開範囲を間違えると、本来非公開にすべき情報まで抜き取られる可能性がある  


### Google Maps APIの仕組み

#### どういうことか
- 太久磨が作ったサイトに Google Maps API を組み込む  
- ユーザーがそのサイトで地図を見ようとすると…  
  - ユーザーのブラウザ → Googleのサーバー（Google Maps） にアクセスが飛ぶ  
  - Googleのサーバーから地図データ（タイル画像や道路情報など）が返ってくる  
- つまり地図の情報源は全部Googleのサーバー  

---

#### ポイント
- 太久磨のサイトは Google Mapsを“借りて表示している” だけ  
- サイトのサーバーに地図データを保存しているわけじゃない  
- ユーザーが地図を操作すると、その都度 Googleのサーバーにリクエストが送られる  

---

#### 実際どう管理されているか
- Googleは APIキー を発行して、どのサイトが利用しているかを管理  
- 一定以上アクセスが来ると課金対象になったり、制限がかかる  
- これで「タダ乗り」や「不正利用」を防いでいる  

---

### まとめ
- ユーザーがサイトを経由して地図を見ても、アクセス先は Googleのサーバー  
- サイトは橋渡しの窓口を用意しているだけ  
- Google側がアクセス数を管理して、制御・課金している  


### Web APIを提供するメリット

- **自サービスの利用者が増える**
  - 例: Google Maps → 不動産サイトや旅行サイトに組み込まれることで、Googleの地図が標準的に使われるようになった  

- **新しい価値を第三者が生み出してくれる**
  - Twitter API → 外部の開発者が分析ツールや予約投稿サービスを作り、Twitter全体の利用価値が上がった  

- **プラットフォーム化できる**
  - APIを公開することで「みんながこのサービスを土台にする」状態を作れる  
  - 例: 決済サービス（PayPal、Stripe）はAPIを公開したからこそ、世界中のECサイトに採用された  

- **収益化につながる**
  - 一定以上のアクセスは有料にする（Google Mapsの商用利用など）  
  - 利用料や契約プランを通じて利益を得られる  

---

### デメリット（リスク）

- **サーバー負荷**
  - アクセスが集中してコストが増える  

- **ユーザー流出**
  - 他社が便利なサービスを作り、自分のユーザーが減る可能性  

- **情報流出リスク**
  - 公開範囲を誤ると、漏らしてはいけないデータまで利用される危険  

---

### バランスの考え方
- 無条件に公開するのは危険  
- だから **APIキーや利用制限** をかけて、管理しながら公開する  
- メリット（普及・収益）とデメリット（負荷・リスク）のバランスを取ることが重要  


### API公開の意味と使い方

- **APIを公開する意味は「コピーされること」ではない**
  - Twitter APIを使って「Twitterそのもの」を作っても意味がないし、利用規約違反

- **APIの正しい使い方は「機能やデータを借りて、新しい価値を作ること」**
  - Twitterの投稿機能を利用して「自動で投稿するボット」を作る
  - ツイートを収集して「トレンド分析ツール」を作る

- **双方にメリットがある**
  - **第三者（開発者）** → 新しいサービスや便利ツールを作れる
  - **提供者（Twitter）** → API経由で利用が増え、サービスの価値が拡張される

---

### まとめ

- APIは **本体を再現するためではなく、機能を借りて広げるための仕組み**  
- 外部アプリやボットが生まれることで  
  - **利用者が増える**  
  - **Twitter自体の価値も高まる**


### 公開情報とAPI

- **一般に公開されている情報は問題ない**
  - Twitterの公開ツイートやタイムラインは誰でも見られる情報
  - APIを経由して取得できても問題はない
  - 非公開アカウントや個人情報にはアクセスできない

---

### ボットの役割

- **Twitter APIの機能を利用して拡張する**
  - 特定のキーワードを含むツイートを見つけたら自動で「いいね」
  - 毎朝9時に自動で天気情報をツイート
  - リプライが来たら自動返信

---

### イメージ

- 本家Twitterの機能（投稿・いいね・検索など）を  
  **API経由で“自動化”したり“組み合わせたり”する** のがボット
- Twitterを丸ごと再現するのではなく  
  **Twitterを土台にして便利な機能を追加するイメージ**

---

### まとめ

- 公開情報を扱うだけなのでセキュリティ的な問題は少ない
- ボットは **APIを通じてTwitterの機能を拡張・自動化するツール**


### 新しいサービスを生み出せる（妄想と構想）

- **前提**
  - 恋愛系の発信でフォロワー向け
  - 恋愛やデートに関心が高い層がすでに集まっている

- **APIの活用**
  - 食べログの店舗データを利用
  - 「デートに向いているお店」をピックアップ
  - 雰囲気・コスパ・立地・ターゲットの属性・アプリの属性・年齢層を考慮してリスト化
←強者から生の声を集める

- **ターゲット向けの価値**
  - 「アポに使えるお店」を探す手間を省ける
  - 信頼できるリストとして利用価値が高い
　 - 口コミサイトは薄すぎて使えない
  - 1アポ辺りのコストが減り、アポの勝率が上がる
  - 写真撮影用の映えるカフェとかもあり


- **マーケティング上の強み**
  - すでにフォロワー基盤があるからリーチしやすい
  - 需要が確定してる
  - 「デート・ターゲット特化」というニッチで差別化できる
　- 学生、ぴえん系、昼職、夜職というようにさらにターゲットを細分化できる
  - 他の発信者と圧倒的な差別化ができる
  - 恋愛系コンテンツと相性抜群→コンテンツ販売、コンサルに繋げられる
  - 訴求：デートは店選びが9割訴求

### HTTPリクエストの3要素（リクエストの中身）

#### 1. リクエストライン
- サーバーに「何をするか」を伝える部分
- 3つで構成される
  - **メソッド**
    - `GET` : データを読み取りたい（Read）
    - `POST`: 新しいデータを作りたい（Create）  
      - リソース名が未定のとき（サーバーに「新しく作ってね」とお願いするイメージ）
    - `PUT` : データを更新したい／新しく作りたい（Update or Create）  
      - リソース名が決まっているとき（サーバーに「これをこの名前で保存してね」とお願いするイメージ）
    - `DELETE`: データを削除したい（Delete）
    - → この4つは「CRUD（Create, Read, Update, Delete）」に対応している
  - **リクエストURL**
    - どのデータを操作するか（住所みたいなもの）
    - 例: `/users/1`
  - **HTTPバージョン**
    - 通信のルールのバージョン
    - 例: `HTTP/1.1` or `HTTP/2`


### HTTPメソッドとSQLの対応関係

- **GET → SELECT**
  - データを「読み取る」
  - 例: ユーザー一覧を取得  
    - HTTP: `GET /users`  
    - SQL: `SELECT * FROM users;`

- **POST → INSERT**
  - 新しいデータを「追加する」
  - 例: 新規ユーザーを作成  
    - HTTP: `POST /users`  
    - SQL: `INSERT INTO users (name, email) VALUES ('太久磨', 'takuma@example.com');`

- **PUT → UPDATE（＋INSERTの場合もあり）**
  - 既存データを「更新」する（なければ新規作成することもある）
  - 例: ID=1のユーザーを更新  
    - HTTP: `PUT /users/1`  
    - SQL: `UPDATE users SET name='Takuma Hirai' WHERE id=1;`

- **DELETE → DELETE**
  - データを「削除する」
  - 例: ID=1のユーザーを削除  
    - HTTP: `DELETE /users/1`  
    - SQL: `DELETE FROM users WHERE id=1;`

---

### まとめ
- **HTTPメソッド = クライアントからの指示**
- **SQL文 = サーバーがデータベースに出す命令**
- クライアントは直接SQLを書かず、APIを通して「GET/POST/PUT/DELETE」で間接的に操作している



### バックエンドの流れ（例）

1. **クライアントサイド（フロントエンド）**
   - ユーザーが「ログイン」ボタンを押す  

2. **リクエスト送信**
   - ブラウザからAPIへ「このユーザーの情報ある？」と問い合わせ  

3. **バックエンド処理**
   - Pythonなどのプログラムがデータベースに問い合わせ（SQL実行）  
   - 結果を取得して整形（JSON形式などに変換）  

4. **レスポンス返却**
   - APIを通してクライアントに「結果（ユーザー情報）」を返す  


---

#### 2. ヘッダー
- 「追加の情報（メタデータ）」を伝える部分
  - **Content-Type**
    - サーバーに送るデータの形式を指定
    - 例: `application/json`
  - **User-Agent**
    - どんなクライアント（ブラウザやアプリ）から送っているか
    - 例: `Chrome/120.0`
  - **Cookie**
    - サーバーとやり取りするために保持している情報
    - 「Cookieが正体はここに入るヘッダー」

---

#### 3. ボディ
- 実際に送りたいデータを入れる部分（任意）
- 主に `POST` や `PUT` で使う
- 例: JSONデータ
  ```json
  {
    "name": “Takuma”,
    "email": "takuma@example.com"
  }


### HTTPレスポンスの3要素

#### 1. ステータスライン
- 受信に関する基本情報
- 構成:
  - **HTTPバージョン**
    - 例: `HTTP/1.1`
  - **ステータスコード**
    - `2xx Success` : リクエストが受け入れられて正常処理された
    - `4xx Client Error` : クライアントのリクエストに誤りがある
    - `5xx Server Error` : サーバー処理に失敗した
  - **フレーズ**
    - ステータスコードを説明する文字列
    - 例: `200 OK`, `404 Not Found`

---

#### 2. レスポンスヘッダー
- ステータスラインだけでは表せない追加情報
- 主な項目:
  - **Content-Type**
    - 応答データのフォーマット
    - 例: `application/json`, `text/html`
  - **Cache-Control**
    - データをキャッシュしてよいかどうか
    - 例: `no-cache`, `max-age=3600`

---

#### 3. レスポンスボディ
- 実際の応答データが入る部分
- 例（JSON形式）:
  ```json
  {
    "id": 1,
    "name": "太久磨"
  }

### HTTPにおける安全性と冪等性

#### 副作用とは？
- **リソース（データ）が改変されること**
- 例:
  - 副作用あり → 更新・削除
  - 副作用なし → 取得処理（ただしアクセスログは残る）

---

### 安全（Safe）
- **副作用がないこと**
- リソース状態を変化させない、読み取り専用の操作
- 代表例:  
  - `GET` : データを取得するだけ  
  - `HEAD`: ヘッダー情報だけを取得する  

---

### 冪等（Idempotent）
- **何度実行しても結果が変わらないこと**
- 副作用があっても、同じ操作を繰り返すと最終的な状態は同じ
- 例:
  - `PUT` : ID=1の店舗名を「A」に更新 → 何度やっても「A」  
  - `DELETE`: ID=1のデータを削除 → 1回目で消える、その後やっても状態は同じ  

---

### 安全性と冪等性の違い
- **安全** = データを変えない  
- **冪等** = 何回実行しても結果が同じ  

---

### メソッドごとの分類

- **GET / HEAD**
  - 安全 → ○  
  - 冪等 → ○  

- **PUT / DELETE**
  - 安全 → ✕（データが変わるから）  
  - 冪等 → ○（繰り返しても結果は同じ）  

- **POST**
  - 安全 → ✕（データを新規作成するから）  
  - 冪等 → ✕（繰り返すとデータが増えて状態が変わり続ける）  

---

### まとめ
- **安全 = 副作用なし（読み取り専用）**  
- **冪等 = 何度やっても同じ結果になる操作**  
- `GET`は安全かつ冪等、`POST`はどちらでもない、が典型的な整理

## 次やること
- DB_ER図_作成
- REST_udemys17~34
- REST_記事作成
- python_ゴルフ課題復習

## 感じたこと
- 朝の起きる時間は大切。余裕を持って1時間前に起きたい。
- メリハリをつけて勉強をする。2時間感覚。勉強が終わるまでスマホ見ない。

## 学習時間
- 5.50h
