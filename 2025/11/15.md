## 取り組んだ課題一覧
- カートの個数をCartモデルに定義する

## わかったこと

### Djangoで数量を合計する処理のポイント

#### 目的
Cart に紐づく CartItem の quantity（数量）の合計を  
Pythonでループせず、DB側で一発で計算する。

#### コード
```python
total_quantity = self.cartitem_set.aggregate(Sum("quantity"))["quantity__sum"]
```
#### 解説

● cartitem_set  
- Cart → CartItem の「逆参照（1対多）」  
- 「このカートに含まれる CartItem 全部」を取る入口  
  例：self が Cart のとき  
  - self.cartitem_set.all() でそのカートの CartItem 一覧

● aggregate(Sum("quantity"))  
- aggregate()：集計関数を使って「1つの値」にまとめるメソッド  
- Sum("quantity")：quantity の合計を DB 側で計算する指示  
- 戻り値は辞書  
  - {"quantity__sum": 合計値}

● ["quantity__sum"]  
- aggregate の戻り値（辞書）の中から  
  "quantity__sum" というキーで合計値だけを取り出している

#### メリット
- 全ての CartItem を Python 側に取り出してから足し算しない  
- DB に直接 SUM を実行させるので、  
  データ量が増えても高速かつ効率的に合計を計算できる


## 次やること
- チェックアウト機能実装


## 感じたこと
- 

## 学習時間
- 3.95h
