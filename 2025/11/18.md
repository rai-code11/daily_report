## 取り組んだ課題一覧
- Django_ECサイト_チェックアウト機能

## わかったこと
### Djangoのトランザクション

#### 1. トランザクションとは

- 一連のDB処理を「全部成功」か「全部なかったこと」にする仕組み
- 例：
  - `orders` に注文1件
  - `order_items` に商品複数件
  - 途中でエラーが出たら、両方まとめてロールバックしたい

---

#### 2. デフォルト動作：オートコミット

- Django は標準で「1クエリ = 1トランザクション」
- 成功したら即コミット、失敗したらロールバック

```python
MyModel.objects.create(...)  # この1クエリが1トランザクション
```

---

#### 3. リクエスト単位でまとめる：ATOMIC_REQUESTS

- 1リクエスト内の書き込みを全部まとめたいときに使う

```python
# settings.py
DATABASES = {
    "default": {
        # ...
        "ATOMIC_REQUESTS": True,
    }
}
```

- ビューが正常終了 → コミット
- ビューで例外発生 → ロールバック
- 全ビューが毎回トランザクションになるので負荷に注意

---

#### 4. 特定ビューだけトランザクション外：non_atomic_requests

```python
from django.db import transaction
from django.http import HttpResponse

@transaction.non_atomic_requests
def my_view(request):
    do_stuff()  # ここはトランザクション外
    return HttpResponse("done")
```

---

#### 5. 超ざっくり使い分け

- 基本：そのまま（オートコミット任せ）
- 複数クエリを「セットで成功/失敗」にしたい  
  → `transaction.atomic()` / `@transaction.atomic`
- リクエスト全体でまとめたい  
  → `ATOMIC_REQUESTS = True`
- ATOMIC_REQUESTS 使用中で、一部ビューだけ除外したい  
  → `@transaction.non_atomic_requests`


## 次やること
- froms.pyを通過した情報をLineItemテーブルにコピーして、CartItemの中身を削除する←この処理をやってチェックアウト機能を完成させる


## 感じたこと
- fromの使い方が難しい。毎日新しい知識が出てきて大変だけど１つ１つ理解できるようにする。
- Qiitaの記事を書くと理解が深まる。

## 学習時間
- 5.00h
