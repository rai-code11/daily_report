
## 取り組んだ課題一覧  
-a  Udemy_米国AI開発者がゼロから教えるDocker講座_s42〜66

## わかったこと

### Dockerfileの基本構成

#### FROM：ベースイメージの指定
- Dockerfileの一番最初に書く
- 多くの場合はOS（例：Ubuntu）を指定
- 例：
  FROM ubuntu:latest
- このイメージの上にどんどん機能を追加していく

#### RUN：コマンドの実行
- 例：
  RUN touch test
  RUN echo "hello world" > test
- `RUN`の命令ごとにイメージのレイヤーが増えていく
- レイヤーを増やしすぎるとイメージが重くなるので注意
- パッケージのインストールでよく使う

#### レイヤーを減らす工夫
- `RUN`を1つにまとめることでレイヤー数を減らせる
- Linuxではコマンドを `&&` でつなげられる
- 複数パッケージを一括でインストールする書き方：
  RUN apt-get update && apt-get install -y \
      curl \
      nginx \
      cvs
- 開発中は`RUN`を細かく分けておき、検証後にまとめ直すとよい

#### CMD：コンテナ起動時のデフォルト実行コマンド
- 構文：[ "実行ファイル", "引数1", "引数2" ]
- 原則Dockerfileの最後に1つだけ書く
- 例：
  CMD ["nginx", "-g", "daemon off;"]
- `RUN`はビルド時の命令、`CMD`はコンテナ起動時の命令

#### COPY / ADD：ファイルの追加
- ビルドコンテキスト内のファイルをイメージに追加
- `COPY`：単純にコピー
- `ADD`：tarファイルを展開しながらコピーできる
- 例：
  COPY ./index.html /var/www/html/

#### ENV：環境変数の設定
- 構文： ENV キー 値
- プログラムの設定や挙動を外から変えたいときに使う
- 例： ENV LANG ja_JP.UTF-8

#### WORKDIR：作業ディレクトリの設定
- その後の命令が実行されるディレクトリを指定
- 存在しない場合は自動で作成される
- 例：
  WORKDIR /app
  RUN touch hello.txt

### Dockerビルドと実行

#### イメージのビルド
- コマンド： docker build -t myimage .
- `-t`：タグ（名前）をつける
- `.`：カレントディレクトリをビルドコンテキストとして使用

####  build context（ビルドコンテキスト）とは？
- Dockerfileを含むフォルダ全体のこと
- `COPY`や`ADD`はこの中のファイルしか参照できない
- 使わないファイルは入れないほうがよい

####  Dockerfileを指定してビルドする
- 例： docker build -f Dockerfile.dev .

###  CMDとENTRYPOINTの違い

- `CMD`：起動時のコマンド。`docker run`で上書き可能
- `ENTRYPOINT`：起動コマンドを固定する。上書き不可
- 両方ある場合：`CMD`は`ENTRYPOINT`への引数として渡される

###  コンテナ実行オプション

####  -v：ボリュームマウント
- ホストとコンテナでファイル共有
- 例： docker run -it -v ~/Desktop/mounted_folder:/app ubuntu bash

####  -u：ユーザー指定
- コンテナをroot以外のユーザーで実行
- 例： docker run -it -u $(id -u):$(id -g) ubuntu bash

####  -p：ポートマッピング
- ホストとコンテナのポートをつなげる
- 例： docker run -it -p 8888:8888 jupyter/datascience-notebook

####  --cpus / --memory
- コンテナのCPU・メモリ上限を制限
- 例： docker run -it --cpus 2 --memory 1g ubuntu

### その他便利コマンド

- イメージサイズ確認： du -sh ファイル名
- コンテナ情報確認： docker inspect <container_id> | grep -i cpu
- Macのリソース確認：
  sysctl -n hw.logicalcpu_max
  sysctl hw.memsize

### 環境変数を人間にたとえると

- `NAME=太久磨`：名前（誰か）
- `AGE=28`：年齢
- `CITY=静岡県菊川市`：住んでる場所
- `LANG=日本語`：使う言語
- `TZ=Asia/Tokyo`：どこの時間を使うか

→ プログラムやパソコンが「どんな設定で動くべきか」を知るための情報。プロフィールのようなもの。

## 次やること
-a  Udemy_米国AI開発者がゼロから教えるDocker講座_s67~

## 感じたこと
-a  理解しながら進むと時間はかかるが楽しい。タスクベースでこなしていくと充実して勉強することができる。スマホを見ないと学習を効率的にすることができる。

## 学習時間
-6.0h
