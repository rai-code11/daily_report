## 取り組んだ課題一覧
- Django_ECサイト_商品一覧ページ

## わかったこと
### Djangoで「画像付きfixtures」をDBへ格納する手順

### 0. 事前前提

Python 3.12 / Django 4.2系 / Pillow インストール済み

### requirements.txt 例
```text
Django==4.2.25
Pillow>=10.1,<12
```

Dockerを使う場合はビルドし直しが必要：
```bash
docker compose up -d --build
```

---

### 1. settings.py のMEDIA設定
```python
# settings.py
MEDIA_ROOT = BASE_DIR / "media"   # 実ファイルの保存先（土台）
MEDIA_URL  = "/media/"            # ブラウザでの参照URLの接頭辞
```

POINT  
- MEDIA_URL は 末尾スラッシュ推奨（/media/）  
- STATIC_* とは別物（静的ファイル vs ユーザーアップロード）

---

### 2. 画像ファイルの配置
```text
project_root/
  media/                 ← MEDIA_ROOT
    images/              ← upload_to
      afurikaookonohazuku.jpg
      ...
```

fixturesはファイルをコピーしません。必ずここに画像の実体を置く。

---

### 3. モデル定義（models.py）
```python
# product_list/models.py
from django.db import models

class ProductList(models.Model):
    class Meta:
        db_table = "product_list"  # 物理テーブル名を固定（任意）

    id    = models.AutoField(primary_key=True)   # 明示しなくてもOK
    name  = models.CharField(max_length=100)
    price = models.IntegerField(default=0)
    image = models.ImageField(upload_to="images/")  # media/images/ 配下に保存
```

補足  
- 画像のURLはテンプレートで `{{ obj.image.url }}` を使う（`.url` を忘れない）  
- `upload_to="images/"` と fixtures のパス（`images/xxx.jpg`）は必ず整合させる

---

### 4. マイグレーション & テーブル作成
```bash
# ローカル
python manage.py makemigrations
python manage.py migrate

# Docker（サービス名: web の例）
docker compose exec web python manage.py makemigrations
docker compose exec web python manage.py migrate
```

---

### 5. fixtures の作成（your_app/fixtures/test-data.json）
```json
[
  {
    "model": "product_list.ProductList",
    "fields": {
      "id": 1,
      "name": "test_product",
      "price": 1000,
      "image": "images/afurikaookonohazuku.jpg"
    }
  },
  {
    "model": "product_list.ProductList",
    "fields": {
      "id": 2,
      "name": "test_product",
      "price": 1000,
      "image": "images/bengaruwasimimizuku.jpg"
    }
  }
  /* …合計8件 … */
]
```

注意  
- `"model"` は `<アプリ名>.<モデル名>`（`db_table` ではない）  
- 画像パスは `upload_to` 基準の相対パス（先頭に `/media/` や `media/` を付けない）  
- `id` は `fields.id` でも `pk` でも可。重複は不可

---

### 6. データ投入（loaddata）
```bash
# ローカル
python manage.py loaddata test-data.json
# or パス指定
python manage.py loaddata product_list/fixtures/test-data.json

# Docker
docker compose exec web python manage.py loaddata test-data.json
```

成功例（出力）：
```text
Installed 8 object(s) from 1 fixture(s)
```

—

### 7. 固定の8箇所に割り当てたい場合（順序で固定）
```python
# 並び順を固定したいなら display_order をモデルに追加し order_by("display_order")
```

```html
<img src="{{ items.0.image.url }}" alt="{{ items.0.name }}">
...
<img src="{{ items.7.image.url }}" alt="{{ items.7.name }}">
```


## 次やること
- 一覧ページの表示

## 感じたこと
- 毎日走っていると徐々に集中力が上がっている気がする。
- 形になっていくと楽しいと感じる。

## 学習時間
- 5.35h
